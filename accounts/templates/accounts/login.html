{% extends 'base.html' %} {% load static %} {% block content %}
<div class="flex items-center justify-center min-h-screen px-4">
  <!-- Login Card -->
  <div class="w-full max-w-md p-8 bg-white rounded-2xl shadow-lg">
    <!-- Logo Image -->
    <div class="flex flex-col items-center mb-2">
      <img
        src="{% static 'theme/xjg_logo.png' %}"
        alt="XJG Logo"
        class="h-20 w-auto"
      />
    </div>

    <!-- Title -->
    <h2 class="text-2xl font-bold text-center text-gray-900 mb-6">
      Sign in to your account
    </h2>

    <!-- Login Form -->
    <form method="post" class="space-y-5">
      {% csrf_token %}


      <!-- Global error messages (only for login errors) -->
      {% if messages %}
        {% for message in messages %}
          {% if message.tags == "error" %}
            <div
              class="mb-4 px-4 py-2 rounded-lg text-sm font-medium
                    bg-red-100 text-red-700 border border-red-300"
            >
              {{ message }}
            </div>
          {% endif %}
        {% endfor %}
      {% endif %}


      <!-- Username -->
      <div>
        <label
          for="id_username"
          class="block text-sm font-medium text-gray-700 mb-1"
          >Username</label
        >
        <input
          type="text"
          name="username"
          id="id_username"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
          placeholder="Enter your username"
          required
          autofocus
        />
        {% if form.username.errors %}
        <p class="text-xs text-red-500 mt-1">
          {{ form.username.errors|striptags }}
        </p>
        {% endif %}
      </div>

      <!-- Password -->
      <div>
        <label
          for="id_password"
          class="block text-sm font-medium text-gray-700 mb-1"
          >Password</label
        >
        <div class="relative">
          <input
            type="password"
            name="password"
            id="id_password"
            placeholder="Enter your password"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
            required
          />
          <button
            type="button"
            onclick="togglePassword('id_password', this)"
            class="absolute inset-y-0 right-3 flex items-center text-gray-500 hover:text-blue-600"
          >
            <!-- Eye Icon -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7
                   -1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
              />
            </svg>
          </button>
        </div>
        {% if form.password.errors %}
        <p class="text-xs text-red-500 mt-1">
          {{ form.password.errors|striptags }}
        </p>
        {% endif %}
      </div>

      <!-- Submit -->
      <button
        type="submit"
        class="w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none"
      >
        Login
      </button>
    </form>

    <!-- Links -->
    <div class="text-center mt-6 space-y-2">
      <a
        href="{% url 'password_reset' %}"
        class="text-blue-600 hover:underline text-sm"
      >
        Forgot your password?
      </a>
      <p class="text-gray-600 text-sm">
        Donâ€™t have an account?
        <a
          href="{% url 'register' %}"
          class="text-blue-600 hover:underline font-medium"
        >
          Register here
        </a>
      </p>
    </div>
  </div>

  <!-- Account Deactivated Modal -->
  {% if account_deactivated %}
  <div
    id="deactivatedModal"
    class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-20"
  >
    <div class="bg-white rounded-xl shadow-lg max-w-sm p-6 text-center">
      <h2 class="text-2xl font-semibold text-gray-900 mb-3">
        Account Deactivated
      </h2>
      <p class="text-gray-700 mb-5">
        Your account has been deactivated. Please contact support or an
        administrator if you think this is a mistake.
      </p>
      <a
        href="{% url 'login' %}"
        class="px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
      >
        Return
      </a>
    </div>
  </div>
  {% endif %}
</div>

<script>
  function togglePassword(id, btn) {
    const input = document.getElementById(id);
    if (input.type === "password") {
      input.type = "text";
      btn.querySelector("svg").classList.add("text-blue-600");
    } else {
      input.type = "password";
      btn.querySelector("svg").classList.remove("text-blue-600");
    }
  }
</script>
{% endblock %}
